<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Batch Image Editor</title>
</head>
<body>
    <h1>Batch Image Editor</h1>

    <input id="folder" type="file" webkitdirectory multiple>
    <br><br>

    <button id="toggle">Show Images</button>

    <div id="output"></div>

    <script type="module">
        import init, { generate_image_html } from "./pkg/wasm_image_viewer.js";

        let show = false;
        let files = [];

        async function run() {
            await init();

            const folderInput = document.getElementById("folder");
            const toggleBtn = document.getElementById("toggle");
            const output = document.getElementById("output");

            // Wait to see if a folder has been selected
            folderInput.addEventListener("change", () => {
                files = Array.from(folderInput.files);
                update();
            });

            // Wait to see if show iamges button has been pressed
            toggleBtn.addEventListener("click", () => {
                show = !show;
                toggleBtn.textContent = show ? "Hide Images" : "Show Images";
                update();
            });
            
            function update() {
                const arr = new Array(...files);
                output.innerHTML = generate_image_html(show, arr);
            }
        }

        run();
    </script>
</body>
</html>
